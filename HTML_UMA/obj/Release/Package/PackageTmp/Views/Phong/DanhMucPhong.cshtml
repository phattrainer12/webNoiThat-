@model PagedList.IPagedList<HTML_UMA.Models.Product>
@{
    ViewBag.Title = "DanhMucSanPham";
    Layout = "~/Views/Shared/_Layout.cshtml";
    var dataMenu = ViewBag.NameCategory as HTML_UMA.Models.Menu;
    var child = ViewBag.Categorychild as IEnumerable<HTML_UMA.Models.Menu>;
}
<div class="main-container col2-left-layout">
    <div class="breadcrumbs">
        <div class="container">
            <div class="row">
                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                    <div class="breadcrumb-wrapper">
                        <ul class="breadcrumb">
                            <li class="home">
                                <a href="/" title="Quay lại trang chủ">
                                    <span class="fa fa-home"></span>
                                </a>
                            </li>
                            <li class="category9">
                                <a href="@Url.Action("DanhMucSanPham", "SanPham", new { IDDanhMuc = dataMenu.Menu_ID })" title="">
                                    Sản phẩm
                                </a>
                            </li>
                            <li class="category10">
                                <a></a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="container-top">
    </div>
    <div class="container">
        <div class="main row">
            <div class="col-left sidebar uma-lg-2 col-md-3 col-sm-4 col-xs-12">
                <div class="block categories hidden-xs">
                    <div class="block-contents">
                        <style type="text/css">
                            #cssmenu.two-level > ul > li > a:after {
                                background-image: url("/skin/frontend/uma/default/images/icons/arrow.svg");
                            }
                        </style>
                        @Html.Action("MenuRoomlv2", "Menu")
                    </div>
                </div>
                <div class="block block-layered-nav">
                    <div class="block-title hidden-lg hidden-md hidden-sm">
                        <div class="wrapper">
                            <span class="text text-uppercase">Filter</span>
                            <div class="toggle-filter-display">
                                <span class="icon" style="background: url('https://uma.vn/skin/frontend/uma/default/images/icons/filters.svg') no-repeat;"></span>
                            </div>
                        </div>
                        <script type="text/javascript">
                            $j(".block-layered-nav").on("click", ".toggle-filter-display", function (event) {
                                $current = $j(event.currentTarget);
                                $current.closest(".block-layered-nav").toggleClass("open");
                            })
                        </script>
                    </div>
                    <div class="block-content hidden-xs">
                        <div class="filter-state">
                        </div>
                        <div id="narrow-by-list" class="filters">
                            <div class="filter clearfix sort-products">
                                <style type="text/css">
                                    .sort-container .caret {
                                        width: 20px;
                                        height: 20px;
                                        background: url("https://uma.vn/skin/frontend/uma/default/images/icons/arrow.svg") no-repeat;
                                    }
                                </style>
                                <div class="sort-container">
                                    <div class="header">
                                        <h4>
                                            Xếp theo:
                                            <div class="hidden-lg hidden-md hidden-sm toggle-display">
                                                <span class="icon" style="background: url('https://uma.vn/skin/frontend/uma/default/images/icons/filters.svg') no-repeat;"></span>
                                            </div>
                                        </h4>
                                    </div>
                                    <div class="contents hidden-xs">
                                        <select class="form-control product-sort-select">
                                            <option id="des">Giá  cao đến thấp</option>
                                            <option id="asc">Giá  thấp đến cao</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="filter clearfix">
                                <div class="header">
                                    <h4>
                                        Lọc theo giá :
                                    </h4>
                                </div>
                                <div class="contents ">
                                    <p class="text-center hidden-xs">
                                        <span>Giá từ:</span>
                                    </p>
                                    <section class="range-slider">
                                        <span class="rangeValues">0 VNĐ - 5000000 VNĐ</span>
                                        <input value="0" min="0" max="5000000" step="500" type="range">
                                        <input value="5000000" min="0" max="5000000" step="500" type="range">
                                    </section>
                                    <div class="text-center">
                                        <button class="filter-price">Lọc sản phẩm</button>
                                    </div>
                                    <style>
                                        section.range-slider {
                                            position: relative;
                                            width: 100%;
                                            height: 100px;
                                            float: left;
                                            text-align: center;
                                        }

                                            section.range-slider input[type="range"] {
                                                pointer-events: none;
                                                position: absolute;
                                                -webkit-appearance: none;
                                                -webkit-tap-highlight-color: #FFF;
                                                border: none;
                                                height: 10px;
                                                width: 10px;
                                                background: #29a653;
                                                box-shadow: inset 0 1px 0 0 #cdc6c6, inset 0 -1px 0 0 #29a653;
                                                -webkit-box-shadow: inset 0 1px 0 0 #cdc6c6, inset 0 -1px 0 0 #29a653;
                                                left: 0;
                                                top: 50px;
                                                width: 100%;
                                                height: 5px;
                                                margin: 0;
                                                padding: 0;
                                            }

                                                section.range-slider input[type="range"]::-webkit-slider-thumb {
                                                    pointer-events: all;
                                                    position: relative;
                                                    z-index: 1;
                                                    outline: 0;
                                                    -webkit-appearance: none;
                                                    width: 10px;
                                                    height: 12px;
                                                    border: none;
                                                    background-image: -webkit-gradient(linear, left top, left bottom, color-stop(0%, #29a653), color-stop(100%, #413f41));
                                                    /* android <= 2.2 */
                                                    background-image: -webkit-linear-gradient(top, #dad8da 0, #29a653 100%);
                                                    /* older mobile safari and android > 2.2 */
                                                    background-image: linear-gradient(to bottom, #dad8da 0, #29a653 100%);
                                                    /* W3C */
                                                }

                                                section.range-slider input[type="range"]::-moz-range-thumb {
                                                    pointer-events: all;
                                                    position: relative;
                                                    z-index: 10;
                                                    -moz-appearance: none;
                                                    width: 20px;
                                                    height: 20px;
                                                    border: none;
                                                    border-radius: 14px;
                                                    background-image: linear-gradient(to bottom, #c41230 0, #c41230 100%);
                                                    /* W3C */
                                                }

                                                section.range-slider input[type="range"]::-ms-thumb {
                                                    pointer-events: all;
                                                    position: relative;
                                                    z-index: 10;
                                                    -ms-appearance: none;
                                                    width: 20px;
                                                    height: 20px;
                                                    border-radius: 14px;
                                                    border: 0;
                                                    background-image: linear-gradient(to bottom, #dad8da 0, #413f41 100%);
                                                    /* W3C */
                                                }

                                                section.range-slider input[type="range"]::-moz-range-track {
                                                    position: relative;
                                                    z-index: -1;
                                                    background-color: black;
                                                    border: 0;
                                                }

                                                section.range-slider input[type="range"]:last-of-type::-moz-range-track {
                                                    -moz-appearance: none;
                                                    background: #EEE transparent;
                                                    border: 0;
                                                }

                                                section.range-slider input[type="range"]::-moz-focus-outer {
                                                    border: 0;
                                                }

                                        .filter-price {
                                            margin: auto;
                                        }
                                    </style>
                                    <div class="clear"></div>
                                </div>
                            </div>
                            <div class="filter clearfix">
                                <div class="header">
                                    <h4>
                                        Lọc theo màu sắc:
                                        <div class="hidden-lg hidden-md hidden-sm toggle-display">
                                            <span class="icon" style="background: url('https://uma.vn/skin/frontend/uma/default/images/icons/filters.svg') no-repeat;"></span>
                                        </div>
                                    </h4>
                                </div>
                                <div class="contents hidden-xs">
                                    <ol class="configurable-swatch-list">
                                        <li style="line-height: 19px;">
                                            <span class="swatch-link has-image" data-id-color="6">
                                                <span class="swatch-label" style="height:15px; width:15px;">
                                                    <img src="https://uma.vn/media/catalog/swatches/2/15x15/media/beige.png" alt="Be" title="Be" width="15" height="15">
                                                </span>
                                            </span>
                                        </li>
                                        <li style="line-height: 19px;">
                                            <span class="swatch-link has-image" data-id-color="1">
                                                <span class="swatch-label" style="height:15px; width:15px;">
                                                    <img src="https://uma.vn/media/catalog/swatches/2/15x15/media/orange.png" alt="Cam" title="Cam" width="15" height="15">
                                                </span>
                                            </span>
                                        </li>
                                        <li style="line-height: 19px;">
                                            <span class="swatch-link has-image" data-id-color="9">
                                                <span class="swatch-label" style="height:15px; width:15px;">
                                                    <img src="https://uma.vn/media/catalog/swatches/2/15x15/media/pink.png" alt="Hồng" title="Hồng" width="15" height="15">
                                                </span>
                                            </span>
                                        </li>
                                        <li style="line-height: 19px;">
                                            <span class="swatch-link has-image" data-id-color="3">
                                                <span class="swatch-label" style="height:15px; width:15px;">
                                                    <img src="https://uma.vn/media/catalog/swatches/2/15x15/media/brown.png" alt="Nâu" title="Nâu" width="15" height="15">
                                                </span>
                                            </span>
                                        </li>
                                        <li style="line-height: 19px;">
                                            <span class="swatch-link has-image" data-id-color="13">
                                                <span class="swatch-label" style="height:15px; width:15px;">
                                                    <img src="https://uma.vn/media/catalog/swatches/2/15x15/media/mixed.png" alt="Nhiều màu" title="Nhiều màu" width="15" height="15">
                                                </span>
                                            </span>
                                        </li>
                                        <li style="line-height: 19px;">
                                            <span class="swatch-link has-image" data-id-color="10">
                                                <span class="swatch-label" style="height:15px; width:15px;">
                                                    <img src="https://uma.vn/media/catalog/swatches/2/15x15/media/purple.png" alt="Tím" title="Tím" width="15" height="15">
                                                </span>
                                            </span>
                                        </li>
                                        <li style="line-height: 19px;">
                                            <span class="swatch-link has-image" data-id-color="11">
                                                <span class="swatch-label" style="height:15px; width:15px;">
                                                    <img src="https://uma.vn/media/catalog/swatches/2/15x15/media/white.png" alt="Trắng" title="Trắng" width="15" height="15">
                                                </span>
                                            </span>
                                        </li>
                                        <li style="line-height: 19px;">
                                            <span class="swatch-link has-image" data-id-color="2">
                                                <span class="swatch-label" style="height:15px; width:15px;">
                                                    <img src="https://uma.vn/media/catalog/swatches/2/15x15/media/yellow.png" alt="Vàng" title="Vàng" width="15" height="15">
                                                </span>
                                            </span>
                                        </li>
                                        <li style="line-height: 19px;">
                                            <span class="swatch-link has-image" data-id-color="4">
                                                <span class="swatch-label" style="height:15px; width:15px;">
                                                    <img src="https://uma.vn/media/catalog/swatches/2/15x15/media/grey.png" alt="Xám" title="Xám" width="15" height="15">
                                                </span>
                                            </span>
                                        </li>
                                        <li style="line-height: 19px;">
                                            <span class="swatch-link has-image" data-id-color="5">
                                                <span class="swatch-label" style="height:15px; width:15px;">
                                                    <img src="https://uma.vn/media/catalog/swatches/2/15x15/media/blue.png" alt="Xanh dương" title="Xanh dương" width="15" height="15">
                                                </span>
                                            </span>
                                        </li>
                                        <li style="line-height: 19px;">
                                            <span class="swatch-link has-image" data-id-color="12">
                                                <span class="swatch-label" style="height:15px; width:15px;">
                                                    <img src="https://uma.vn/media/catalog/swatches/2/15x15/media/green.png" alt="Xanh lá" title="Xanh lá" width="15" height="15">
                                                </span>
                                            </span>
                                        </li>
                                        <li style="line-height: 19px;">
                                            <span class="swatch-link has-image" data-id-color="7">
                                                <span class="swatch-label" style="height:15px; width:15px;">
                                                    <img src="https://uma.vn/media/catalog/swatches/2/15x15/media/black.png" alt="Đen" title="Đen" width="15" height="15">
                                                </span>
                                            </span>
                                        </li>
                                        <li style="line-height: 19px;">
                                            <span class="swatch-link has-image" data-id-color="8">
                                                <span class="swatch-label" style="height:15px; width:15px;">
                                                    <img src="https://uma.vn/media/catalog/swatches/2/15x15/media/red.png" alt="Đỏ" title="Đỏ" width="15" height="15">
                                                </span>
                                            </span>
                                        </li>
                                    </ol>
                                </div>
                            </div>
                        </div>
                        <script type="text/javascript">
                            $j(".block-layered-nav .filter").on("click", ".toggle-display", function (event) {
                                $current = $j(event.currentTarget);
                                $current.closest(".filter").toggleClass("open")
                                    .siblings(".filter").removeClass("open");
                            })
                        </script>

                    </div>
                </div>
            </div>
            <div class="col-main uma-lg-8 col-md-9 col-sm-8 col-xs-12">
                <div class="container-fluid categories-landing-page nopadding">
                    <div class="categories">
                        @foreach (var item in child)
                        {
                            <div class="col-lg-4 col-md-6 col-sm-6 col-xs-6 uma-xxs-6 category">
                                <div class="contents">
                                    <div class="image">
                                        <a href="@Url.Action("DanhMucPhong","Phong", new { IDPhong = item.Menu_ID})">
                                            <img class="img-responsive" src="@item.Image" title="Nệm" width="100%">
                                        </a>
                                    </div>
                                    <div class="info">
                                        <p>
                                            <a href="@Url.Action("DanhMucPhong","Phong", new { IDPhong = item.Menu_ID})" class="name text-uppercase">@item.Name <span>@Html.Action("getCountProduct", "Product", new { Menu_ID = item.Menu_ID })</span></a>
                                        </p>
                                    </div>
                                </div>
                            </div>

                        }
                    </div>
                </div>
                <div>
                    <div class="row">
                        <h3 class="page-title" data-menu-id="@dataMenu.Menu_ID">
                            <span>@dataMenu.Name</span>
                        </h3>
                    </div>
                    <div class="row">
                        <div class="category-products clearfix">
                            <div id="products-grid" class="products-grid clearfix">
                                @Html.Action("AjaxLoading", "Phong", new { IDPhong = dataMenu.Menu_ID, Page = 1 })
                            </div>
                        </div>
                    </div>
                </div>
                <div id="Loading" style="opacity: 0;text-align:center">
                    <p style="color:red"><img src="https://uma.vn/media/magehouse/slider/default/ajax-loader.gif">Đang tải thêm sản phẩm ...</p>
                </div>
            </div>
        </div>
    </div>
</div> url: '/Phong/AjaxLoading',
                                        type: 'GET',
                                        data: { IDPhong: @dataMenu.Menu_ID, Page: page },
                                        <script>

                            var page = 1;
                            var pagelist = Number($('.page-list').text());
                            //loadding
                            $(window).on("scroll", function () {
                                var scrollHeight = $(document).height();
                                var scrollPosition = $(window).height() + $(window).scrollTop();
                                setTimeout(function () {
                                    if ((scrollHeight - scrollPosition) / scrollHeight === 0 && page <= pagelist) {
                                        $('#Loading').attr("style", "opacity: 1;text-align:center")
                                        $.ajax({
                                            url: '/Phong/AjaxLoading',
                                            type: 'GET',
                                            data: { IDPhong: @dataMenu.Menu_ID, Page: page },
                                            success: function (data) {
                                                $('.products-grid').append(data);
                                                page++;
                                            },
                                        });
                                    }
                                    else {
                                        $('#Loading').attr("style", "opacity: 0;text-align:center")
                                    }
                                }, 1500);
                            });
                            $(document).ready(function () {
                                //Orderby -----------
                                //Des
                                $('.product-sort-select').change(function () {
                                    var listproduct = $('.product');
                                    if ($('option[id="des"]').prop("selected") == true) {
                                        $('#products-grid').empty();
                                        var i, j, tmp;
                                        for (i = 0; i < listproduct.length; i++) {
                                            for (j = i + 1; j < listproduct.length; j++) {
                                                if (Number($(listproduct[i]).find('.price').text().replace(/,/g, "")) < Number($(listproduct[j]).find('.price').text().replace(/,/g, ""))) {
                                                    //cach trao doi gia tri
                                                    tmp = listproduct[i];
                                                    listproduct[i] = listproduct[j]
                                                    listproduct[j] = tmp;
                                                }
                                            }
                                        }
                                        $('#products-grid').append(listproduct);
                                    }
                                });
                                //end des
                                //Asc
                                $('.product-sort-select').change(function () {
                                    var listproduct = $('.product');
                                    if ($('option[id="asc"]').prop("selected") == true) {
                                        $('#products-grid').empty();
                                        var i, j, tmp;
                                        for (i = 0; i < listproduct.length; i++) {
                                            for (j = i + 1; j < listproduct.length; j++) {
                                                if (Number($(listproduct[i]).find('.price').text().replace(/,/g, "")) > Number($(listproduct[j]).find('.price').text().replace(/,/g, ""))) {
                                                    //cach trao doi gia tri
                                                    tmp = listproduct[i];
                                                    listproduct[i] = listproduct[j]
                                                    listproduct[j] = tmp;
                                                }
                                            }
                                        }
                                        $('#products-grid').append(listproduct);
                                    }
                                });
                                //end Asc
                            });


                            //Set layout
                            $('.category:first-child').removeClass('col-lg-4 col-md-6 col-xs-6')
                            $('.category:first-child').addClass('col-lg-8 col-md-8 col-xs-12')
                                        </script>
                                        <script>
                                            //Filter price product
                                            var Menu_ID = $('.page-title').data('menu-id');
                                            var x;
                                            var y;
                                            function getVals() {
                                                // Get slider values
                                                var parent = this.parentNode;
                                                var slides = parent.getElementsByTagName("input");
                                                var slide1 = parseFloat(slides[0].value);
                                                var slide2 = parseFloat(slides[1].value);
                                                // Neither slider will clip the other, so make sure we determine which is larger
                                                if (slide1 > slide2) { var tmp = slide2; slide2 = slide1; slide1 = tmp; }

                                                var displayElement = parent.getElementsByClassName("rangeValues")[0];
                                                x = slide1;
                                                y = slide2;
                                                displayElement.innerHTML = "" + slide1 + " VNĐ - " + slide2 + " VNĐ";
                                                //event

                                            }
                                            var listproduct = $('.product');
                                            $('input').mouseup(function () {
                                                var listfilter = [];
                                                var page = [];
                                                $('#products-grid').empty();
                                                listproduct.each(function () {
                                                    var price = Number($(this).find('.price').text().replace(/,/g, ""));
                                                    page.push(price);
                                                });
                                                for (i = 0; i < listproduct.length; i++) {
                                                    var value = Number($(listproduct[i]).find('.price').text().replace(/,/g, ""))
                                                    if (value > x && value < y) {
                                                        listfilter.push(listproduct[i]);
                                                    }
                                                }
                                                $('#products-grid').append(listfilter);
                                            });
                                            window.onload = function () {
                                                // Initialize Sliders
                                                var sliderSections = document.getElementsByClassName("range-slider");
                                                for (var x = 0; x < sliderSections.length; x++) {
                                                    var sliders = sliderSections[x].getElementsByTagName("input");
                                                    for (var y = 0; y < sliders.length; y++) {
                                                        if (sliders[y].type === "range") {
                                                            sliders[y].oninput = getVals;
                                                            // Manually trigger event first time to display values
                                                            sliders[y].oninput();
                                                        }
                                                    }
                                                }
                                            }
                                        </script>
